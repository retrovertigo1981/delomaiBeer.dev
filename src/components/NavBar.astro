---
// JS

const { variedades } = Astro.props;
const navItems = [
  { label: "about", href: "about.html" },
  {
    label: "variedades",
    href: "#",
    subItems: variedades?.map((variedad) => ({
      label: variedad?.data?.title,
      href: `/variedades/${variedad.slug}`,
    })),
  },
  { label: "Beerpacks", href: "beerpacks.html" },
  {
    label: "contacto",
    href: "https://wa.me/56944058555",
    isExternal: true,
    icon: "/icons/whatsapp-vector.svg",
  },
];
---

<nav>
  <img src='/icons/ham-menu.svg' alt='menu' class='menu' />

  <div class='navbar-left'>
    <a href='/index.html'>
      <img class='nav-logo' src='/logos/delomai.svg' alt='Logo Delomai' />
    </a>
  </div>

  <div class='navbar-right'>
    <ul>
      {
        navItems.map((item) => (
          <li>
            <a
              href={item.href}
              {...(item.isExternal
                ? { target: "_blank", rel: "noopener noreferrer" }
                : {})}
            >
              {item.label}
              {item.icon && (
                <span>
                  <img src={item.icon} alt={`${item.label} icon`} />
                </span>
              )}
            </a>
            {item.subItems && (
              <div class='beers-menu'>
                {item.subItems.map((subItem) => (
                  <a href={subItem.href}>{subItem.label}</a>
                ))}
              </div>
            )}
          </li>
        ))
      }
    </ul>
  </div>

  <a
    class='wsp'
    href='https://wa.me/56944058555'
    target='_blank'
    rel='noopener noreferrer'
  >
    <img class='wsp' src='/icons/whatsapp-vector.svg' alt='Whatsapp Logo' />
  </a>

  <div class='mobile-menu' id='mobile-menu'>
    <ul>
      {
        navItems.flatMap((item) => [
          <li>
            <a href={item.href}>{item.label}</a>
          </li>,
          ...(item.subItems || []).map((subItem) => (
            <li>
              <a href={subItem.href}>{subItem.label}</a>
            </li>
          )),
        ])
      }
    </ul>
  </div>
</nav>

<style>
  nav {
    /* display: flex; */
    display: grid;
    grid-template-columns: repeat(2, max-content);
    grid-template-rows: repeat(2, max-content);
    justify-content: space-between;
    padding: 20px 70px;
    background-color: #000000;
  }

  nav .menu {
    display: none;
  }

  nav .wsp {
    display: none;
  }

  .navbar-left {
    display: flex;
    align-items: center;
  }

  .navbar-left a .nav-logo {
    width: 155px;
    height: 50px;
  }

  .navbar-right ul {
    list-style: none;
    display: grid;
    grid-template-columns: repeat(4, max-content);
    align-items: center;
    height: 60px;
  }

  .navbar-right ul li {
    padding-right: 50px;
  }

  .navbar-right li a {
    text-decoration: none;
    font-family: RootBeer;
    color: #ffffff;
    font-size: 2.6rem;
  }

  .navbar-right ul li:nth-child(4) {
    padding-right: 0;
    border: 2px solid #ffffff;
    border-radius: 30px;
    padding: 8px 18px;
  }

  .navbar-right ul li:nth-child(4):hover {
    border: 2px solid #d0a35c;
    transition: 400ms;
  }

  .navbar-right ul li:nth-child(4):hover a {
    color: #d0a35c;
    transition: 400ms;
  }

  /* .navbar-right ul li:nth-child(4):hover a span .wsp {
    color: #d0a35c;
    transition: 400ms;
  } */

  .navbar-right ul li a:hover {
    color: #d0a35c;
    fill: #d0a35c;
    transition: 400ms;
  }

  .navbar-right ul li:nth-child(2):hover .beers-menu {
    opacity: 1;
    z-index: 1;
    transition: opacity 400ms;
    transition-delay: 400ms;
  }

  .navbar-right ul li:nth-child(2):active .beers-menu {
    opacity: 1;
    z-index: 1;
    transition: opacity 400ms;
    transition-delay: 400ms;
  }

  .navbar-right ul li a span svg path {
    display: inline-block;
    width: 26px;
    height: 25px;
  }

  .mobile-menu {
    position: absolute;
    top: 10%;
    display: grid;
    align-content: center;
    justify-content: center;
    left: 0;
    width: 100%;
    height: 90vh;
    background-color: #000000;
    z-index: 1;

    transform: translateX(-100%);
    transition: transform 300ms;
  }

  .active {
    transform: translateX(0);
    transition: transform 400ms;
  }

  .mobile-menu ul {
    padding-left: 0px;
  }
  .mobile-menu ul li {
    margin-bottom: 20px;
    list-style: none;
  }

  .mobile-menu ul li ul {
    padding-top: 20px;
  }
  .mobile-menu ul li a {
    text-decoration: none;
    font-family: RootBeer;
    color: #ffffff;
    font-size: 3.5rem;
    letter-spacing: 3px;
  }

  .navbar-right .beers-menu {
    position: absolute;
    display: grid;
    grid-template-rows: repeat(5, max-content);
    background-color: #000000;
    gap: 5px;
    padding: 20px 20px;
    border-radius: 5px;
    opacity: 0;
    transition: opacity 400ms;
    transition-delay: 400ms;
  }

  @media screen and (min-width: 761px) {
    .mobile-menu {
      opacity: 0;
    }
  }

  @media screen and (max-width: 760px) {
    nav {
      display: flex;
    }
    nav .menu {
      display: block;
    }

    nav .wsp {
      display: flex;
      align-items: center;
    }

    nav .wsp img {
      width: 30px;
      height: 31px;
    }

    .navbar-right {
      display: none;
    }
  }

  @media screen and (max-width: 880px) {
    nav {
      padding: 10px 10px;
    }
  }
</style>

<script>
  const mobileMenu = document.querySelector(".mobile-menu");
  const menuHamIcon = document.querySelector(".menu");

  menuHamIcon.addEventListener("click", toggleMobileMenu);

  function toggleMobileMenu() {
    mobileMenu.classList.toggle("active");
  }
</script>
